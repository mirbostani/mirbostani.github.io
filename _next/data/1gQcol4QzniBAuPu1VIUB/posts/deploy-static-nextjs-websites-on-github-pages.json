{"pageProps":{"slug":"deploy-static-nextjs-websites-on-github-pages","postData":{"slug":"deploy-static-nextjs-websites-on-github-pages","contentHtml":"<h2>Create a Next.js Application</h2>\n<p>Next.js is a modern JavaScript framework that offers server-side rendering (SSR) and static site generation (SSG) features. Using SSG with Next.js enables you to build a static HTML version of your website at the build time. Then, you can deploy it on any webserver (i.e., GitHub Pages and Actions) you like. It makes the page loading process extremely fast for the users. For more information regarding the best practice for creating a static website with Next.js, please consult its <a href=\"https://nextjs.org/docs/advanced-features/static-html-export\">documentation</a>.</p>\n<p>Create a Next.js application based on the blog-starter kit that is provided <a href=\"https://github.com/vercel/next.js/tree/canary/examples\">here</a>. Then, navigate to the project directory and start the development server.</p>\n<pre><code class=\"language-shell\">$ npx create-next-app mywebsite --use-npm --example \"https://github.com/vercel/next-learn-starter/tree/master/learn-starter\"\n$ cd mywebsite\n$ npx next dev --port 3333\n</code></pre>\n<p><img src=\"/post/deploy-static-nextjs-websites-on-github-pages/nextjs-blog-starter.png\" alt=\"nextjs-starter\"></p>\n<h2>Generate a Static Site</h2>\n<p>You can modify the application as you like. However, remember that the <code>export</code> command, used for generating static pages, does not support the <code>next/image</code> component, as this component relies on Image Optimization API. Possible ways to fix this issue are addressed <a href=\"https://nextjs.org/docs/messages/export-image-api\">here</a>; however, you can use the <code>&#x3C;img></code> HTML tag or the <a href=\"https://github.com/cyrilwanner/next-optimized-images\">next-optimized-images</a> package instead of <code>next/image</code>. Besides, <a href=\"https://nextjs.org/docs/advanced-features/i18n-routing\">internationalized (i18n) routing</a> is not compatible with exported pages either because it uses dynamic routing internally for implementation. The <a href=\"https://github.com/martinkr/next-export-i18n\">next-export-i18n</a> package is a suitable alternative.</p>\n<p>To build and export your application to the <code>./dist</code> directory, use the following commands:</p>\n<pre><code class=\"language-shell\">$ npx next build\n$ npx next export -o dist/\n</code></pre>\n<h2>Test on Nginx</h2>\n<p>After exporting a static HTML version of your application, you can test it locally using the Nginx webserver. First, you need to update the package list and install Nginx with these commands:</p>\n<pre><code class=\"language-shell\">$ sudo apt update\n$ sudo apt install nginx\n</code></pre>\n<p>The Nginx service will start automatically after a successful installation. Check if the <code>nginx.service</code> is active and running:</p>\n<pre><code class=\"language-shell\">$ sudo systemctl status nginx\n</code></pre>\n<p>You can point your browser to the <code>localhost</code> address. The following page should appear in your browser.</p>\n<p><img src=\"/post/deploy-static-nextjs-websites-on-github-pages/nginx-active-and-running.png\" alt=\"nginx-active-and-running\"></p>\n<p>For testing purposes, you can now deploy your static website locally using the Nginx webserver. Just copy the <code>dist</code> directory, which contains your generated static website, to the <code>/var/www</code> path.</p>\n<pre><code class=\"language-shell\">$ cd /path/to/project\n$ sudo cp dist/ /var/www\n$ ls /var/www\ndist  html\n</code></pre>\n<p>In order to make your website accessible through <code>localhost:3000</code>, you need to set up a virtual host inside the Nginx webserver.</p>\n<pre><code class=\"language-shell\">$ cd /etc/nginx/sites-available\n$ sudo touch dist\n$ vim dist\n</code></pre>\n<pre><code class=\"language-nginx\">server {\n  listen 3000;\n  listen [::]:3000;\n  server_name dist.example.com;\n  root /var/www/dist;\n  index index.html;\n  location / {\n    try_files $uri $uri/ =404;\n  }\n}\n</code></pre>\n<p>Enable the virtual host that you've just created by creating a symbolic link inside the <code>sites-enabled</code> directory.</p>\n<pre><code class=\"language-shell\">$ cd /etc/nginx/sites-enabled\n$ sudo ln -s /etc/nginx/sites-available/dist dist\n</code></pre>\n<p>Restart Nginx to make the changes take effect.</p>\n<pre><code class=\"language-shell\">$ sudo systemctl restart nginx\n</code></pre>\n<p>You can access the website by pointing your browser to the <code>localhost:3000</code> address.</p>\n<h2>Push to GitHub</h2>\n<p>Create a repository with <code>&#x3C;yourusername.github.io></code> structure. You should substitute <code>yourusername</code> with your GitHub username.</p>\n<p><img src=\"/post/deploy-static-nextjs-websites-on-github-pages/create-github-repository.png\" alt=\"create-github-repository\"></p>\n<p>Create a local repository and merge it with your remote one:</p>\n<pre><code class=\"language-shell\">$ mkdir mirbostani.github.io\n$ cd mirbostani.github.io\n$ git init\n$ git branch -M main\n$ git remote add origin https://github.com/mirbostani/mirbostani.github.io.git\n</code></pre>\n<p>Now, move the content of the <code>dist</code> directory to your local repository. If you want to host your website on GitHub Pages, you should create an empty file called <code>.nojekyll</code> to prevent GitHub Pages to use Jekyll by default.</p>\n<pre><code class=\"language-shell\">$ cp -r /path/to/mywebsite/dist /path/to/mirbostani.github.io\n$ cd /path/to/mirbostani.github.io\n$ touch .nojekyll\n$ git add .\n$ git commit -m \"Initial commit\"\n$ git push\n</code></pre>\n<p>If you don't have a custom domain and want to use your GitHub repository name, you should prefix the asset links by modifying the <code>next.config.js</code> file. Then, redo the exporting and pushing process.</p>\n<pre><code class=\"language-js\">const isProd = process.env.NODE_ENV === \"production\"\n\nmodule.exports = {\n  assetPrefix: isProd ? \"/&#x3C;your-repo-name>/\" : \"\",\n}\n</code></pre>\n<p>Finally, you can visit your website on <code>yourusername.github.io</code>. It should be up and running.</p>\n","contentMarkdown":"\n## Create a Next.js Application\n\nNext.js is a modern JavaScript framework that offers server-side rendering (SSR) and static site generation (SSG) features. Using SSG with Next.js enables you to build a static HTML version of your website at the build time. Then, you can deploy it on any webserver (i.e., GitHub Pages and Actions) you like. It makes the page loading process extremely fast for the users. For more information regarding the best practice for creating a static website with Next.js, please consult its [documentation](https://nextjs.org/docs/advanced-features/static-html-export).\n\nCreate a Next.js application based on the blog-starter kit that is provided [here](https://github.com/vercel/next.js/tree/canary/examples). Then, navigate to the project directory and start the development server.\n\n```shell\n$ npx create-next-app mywebsite --use-npm --example \"https://github.com/vercel/next-learn-starter/tree/master/learn-starter\"\n$ cd mywebsite\n$ npx next dev --port 3333\n```\n\n![nextjs-starter](/post/deploy-static-nextjs-websites-on-github-pages/nextjs-blog-starter.png)\n\n## Generate a Static Site\n\nYou can modify the application as you like. However, remember that the `export` command, used for generating static pages, does not support the `next/image` component, as this component relies on Image Optimization API. Possible ways to fix this issue are addressed [here](https://nextjs.org/docs/messages/export-image-api); however, you can use the `<img>` HTML tag or the [next-optimized-images](https://github.com/cyrilwanner/next-optimized-images) package instead of `next/image`. Besides, [internationalized (i18n) routing](https://nextjs.org/docs/advanced-features/i18n-routing) is not compatible with exported pages either because it uses dynamic routing internally for implementation. The [next-export-i18n](https://github.com/martinkr/next-export-i18n) package is a suitable alternative.\n\nTo build and export your application to the `./dist` directory, use the following commands:\n\n```shell\n$ npx next build\n$ npx next export -o dist/\n```\n\n## Test on Nginx\n\nAfter exporting a static HTML version of your application, you can test it locally using the Nginx webserver. First, you need to update the package list and install Nginx with these commands:\n\n```shell\n$ sudo apt update\n$ sudo apt install nginx\n```\n\nThe Nginx service will start automatically after a successful installation. Check if the `nginx.service` is active and running:\n\n```shell\n$ sudo systemctl status nginx\n```\n\nYou can point your browser to the `localhost` address. The following page should appear in your browser.\n\n![nginx-active-and-running](/post/deploy-static-nextjs-websites-on-github-pages/nginx-active-and-running.png)\n\nFor testing purposes, you can now deploy your static website locally using the Nginx webserver. Just copy the `dist` directory, which contains your generated static website, to the `/var/www` path.\n\n```shell\n$ cd /path/to/project\n$ sudo cp dist/ /var/www\n$ ls /var/www\ndist  html\n```\n\nIn order to make your website accessible through `localhost:3000`, you need to set up a virtual host inside the Nginx webserver.\n\n```shell\n$ cd /etc/nginx/sites-available\n$ sudo touch dist\n$ vim dist\n```\n\n```nginx\nserver {\n  listen 3000;\n  listen [::]:3000;\n  server_name dist.example.com;\n  root /var/www/dist;\n  index index.html;\n  location / {\n    try_files $uri $uri/ =404;\n  }\n}\n```\n\nEnable the virtual host that you've just created by creating a symbolic link inside the `sites-enabled` directory.\n\n```shell\n$ cd /etc/nginx/sites-enabled\n$ sudo ln -s /etc/nginx/sites-available/dist dist\n```\n\nRestart Nginx to make the changes take effect.\n\n```shell\n$ sudo systemctl restart nginx\n```\n\nYou can access the website by pointing your browser to the `localhost:3000` address.\n\n## Push to GitHub\n\nCreate a repository with `<yourusername.github.io>` structure. You should substitute `yourusername` with your GitHub username.\n\n![create-github-repository](/post/deploy-static-nextjs-websites-on-github-pages/create-github-repository.png)\n\nCreate a local repository and merge it with your remote one:\n\n```shell\n$ mkdir mirbostani.github.io\n$ cd mirbostani.github.io\n$ git init\n$ git branch -M main\n$ git remote add origin https://github.com/mirbostani/mirbostani.github.io.git\n```\n\nNow, move the content of the `dist` directory to your local repository. If you want to host your website on GitHub Pages, you should create an empty file called `.nojekyll` to prevent GitHub Pages to use Jekyll by default.\n\n```shell\n$ cp -r /path/to/mywebsite/dist /path/to/mirbostani.github.io\n$ cd /path/to/mirbostani.github.io\n$ touch .nojekyll\n$ git add .\n$ git commit -m \"Initial commit\"\n$ git push\n```\n\nIf you don't have a custom domain and want to use your GitHub repository name, you should prefix the asset links by modifying the `next.config.js` file. Then, redo the exporting and pushing process.\n\n```js\nconst isProd = process.env.NODE_ENV === \"production\"\n\nmodule.exports = {\n  assetPrefix: isProd ? \"/<your-repo-name>/\" : \"\",\n}\n```\n\nFinally, you can visit your website on `yourusername.github.io`. It should be up and running.","readTime":3,"category":"Web Development","title":"Deploy static Next.js websites on GitHub Pages","description":"Use Next.js to develop and export a static HTML version of a website to be hosted on GitHub Pages.","date":"2021-09-16","author":"mirbostani","tags":"nextjs,github"}},"__N_SSG":true}